Today's puzzle was fun! Especially by having to parse 2D input, instead of making decisions line by line. I mean, in the end I still handle one line at a time, but I have to keep context in memory while I do it.

Looking back at the code, it looks a bit messier than the previous ones. But it's probably because the functions are a bit longer.
